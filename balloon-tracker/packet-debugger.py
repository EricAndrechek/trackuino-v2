# known good packet:
# PACKET = "1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 2400 1200 1200 2400 2400 1200 1200 2400 2400 2400 2400 2400 1200 2400 2400 1200 1200 1200 2400 1200 2400 1200 1200 2400 2400 1200 2400 1200 2400 1200 1200 2400 1200 2400 2400 2400 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 2400 1200 1200 1200 1200 2400 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 2400 2400 2400 1200 1200 2400 2400 2400 1200 2400 1200 2400 2400 1200 1200 2400 1200 2400 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 1200 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 1200 2400 1200 2400 1200 2400 1200 1200 1200 1200 1200 2400 2400 2400 2400 2400 2400 1200 2400 1200 2400 1200 1200 2400 2400 1200 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 2400 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 1200 2400 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 1200 1200 1200 2400 2400 2400 1200 2400 1200 2400 1200 1200 1200 1200 2400 1200 2400 1200 2400 1200 2400 2400 1200 2400 1200 2400 1200 1200 2400 1200 1200 2400 2400 1200 1200 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 2400 2400 2400 2400 1200 1200 1200 2400 1200 2400 1200 2400 1200 1200 2400 1200 1200 1200 1200 2400 2400 1200 1200 2400 2400 2400 2400 2400 1200 1200 1200 2400 1200 1200 2400 1200 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 2400 1200 2400 2400 2400 1200 1200 2400 1200 2400 1200 1200 2400 1200 2400 1200 2400 1200 1200 1200 1200 2400 1200 1200 1200 2400 2400 1200 1200 1200 2400 2400 2400 2400 2400 2400 2400 1200 2400 2400 2400 2400 2400 2400 2400 1200 2400 2400 2400 2400 2400 2400 2400 1200"

# testing packet:
PACKET = "1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 1200 1200 1200 1200 1200 1200 2400 1200 2400 1200 1200 2400 2400 1200 1200 2400 2400 2400 2400 2400 1200 2400 2400 1200 1200 1200 2400 1200 2400 1200 1200 2400 2400 1200 2400 1200 2400 1200 1200 2400 1200 2400 2400 2400 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 2400 1200 1200 1200 1200 2400 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 2400 2400 2400 1200 1200 2400 2400 2400 1200 2400 1200 2400 2400 1200 1200 2400 1200 2400 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 1200 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 1200 2400 1200 2400 1200 2400 1200 1200 1200 1200 1200 2400 2400 2400 2400 2400 2400 1200 2400 1200 2400 1200 1200 2400 2400 1200 1200 2400 2400 1200 2400 1200 1200 1200 2400 1200 2400 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 2400 2400 1200 2400 1200 2400 2400 1200 1200 1200 2400 1200 1200 2400 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 1200 1200 1200 2400 2400 2400 1200 2400 1200 2400 1200 1200 1200 1200 2400 1200 2400 1200 2400 1200 2400 2400 1200 2400 1200 2400 1200 1200 2400 1200 1200 2400 2400 1200 1200 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 2400 2400 2400 2400 1200 1200 1200 2400 1200 2400 1200 2400 1200 1200 2400 1200 1200 1200 1200 2400 2400 1200 1200 2400 2400 2400 2400 2400 1200 1200 1200 2400 1200 1200 2400 1200 1200 1200 1200 2400 1200 2400 2400 2400 1200 1200 1200 2400 1200 2400 2400 1200 2400 2400 2400 1200 1200 2400 1200 2400 1200 1200 2400 1200 2400 1200 2400 1200 1200 1200 1200 2400 1200 1200 1200 2400 2400 1200 1200 1200 2400 2400 2400 2400 2400 2400 2400 1200 1200 1200 1200 1200 1200 1200 1200 2400 2400 2400 2400 2400 2400 2400 1200 2400 2400 2400 2400 2400 2400 2400 1200 2400 2400 2400 2400 2400 2400 2400 1200"

PACKET = PACKET.split(" ")

# decode from NRZI
last = 1200
binary_data = []
for datum in PACKET:
    if int(datum) == last:
        binary_data.append(1)
    else:
        binary_data.append(0)
        last = int(datum)

# undo bit stuffing
hex_data = []
for i in range(0, len(binary_data) - 7, 8):
    # every 0 after 5 1s is a stuffed bit
    # unless it's after 6 1s

    hex_value = 0x00

    consecutive_ones = 0

    for j in range(0, 8):
        if binary_data[i + j] == 1:
            consecutive_ones += 1
            hex_value <<= 1
            hex_value |= 1
        elif consecutive_ones == 5:
            consecutive_ones = 0
            i += 1
        else:
            hex_value <<= 1
            hex_value |= 0
    
    hex_data.append(hex_value)

# print hex data as hex, with 2 characters per byte and uppercase and 0x prefix
print(" ".join(["0x" + hex(byte)[2:].upper().zfill(2) for byte in hex_data]))